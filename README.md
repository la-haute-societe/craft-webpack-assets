# Webpack assets - Craft plugin

## Install

```
composer require la-haute-societe/craft-webpack-assets 
```


## Usage

```html
<html>
<head>
    ...
   
    {{ craft.webpackAssets.cssTags() | raw }}
    
    ... Or with chunk name ...
    {{ craft.webpackAssets.cssTags('app') | raw }}
   
    ...
</head>
<body>
...

{{ craft.webpackAssets.jsTags() | raw }}

... Or with chunk name ...

{{ craft.webpackAssets.jsTags('app') | raw }}
{{ craft.webpackAssets.jsTags('libs') | raw }}

...
</body>
</html>
```


## Configuration

Create ``webpackassets.php`` file in the ``craft/config`` folder with the following content
and update the path to the JSON generated by Webpack.

```php
<?php

return [
    'jsonPath' => realpath(dirname(__FILE__) . '/path/to/generated-assets-files.json'),
];
```


## Generate generated-assets-files.json with Webpack

- Add the following packages :
```
yarn add html-webpack-plugin write-file-webpack-plugin underscore-template-loader -D

# Or
npm install html-webpack-plugin write-file-webpack-plugin underscore-template-loader --save-dev
```

- Create a ``assets-files.json.tpl`` file with this content :
```
<%= JSON.stringify( htmlWebpackPlugin ) %>
```

- In Webpack config add the following plugins :

```js
{
    plugins: [
        new HtmlWebpackPlugin({
            filename: 'generated-assets-files.json',
            template: 'underscore-template-loader!path/to/templates/assets-files.json.tpl',
            inject: false,
            chunksSortMode: 'dependency'
        }),
        new WriteFilePlugin({
            test:  /generated-assets-files\.json$/,
            force: true,
            log: false
        })
    ]
}
```